- job:
    name: remove_line_from_branches_file
    description: 'This job remove a first line with branch from given file.'
    parameters:
      - !include: './maxscale_jobs/include/branch_to_check.yaml'
      - !include: './maxscale_jobs/include/branches_list.yaml'
      - !include: './maxscale_jobs/include/repo.yaml'
    builders:
      - shell: |
          LINE_NUMBER=$(grep -n --max-count=1 "$branch_to_check|" $file | cut -f1 -d:)
          if [ -z $LINE_NUMBER ]; then
            echo "$branch_to_check not exist!"
            exit 1
          fi
          echo "$branch_to_check exist"
          $(sed -i $LINE_NUMBER"d" $file)
          echo "$branch_to_check remove success"
